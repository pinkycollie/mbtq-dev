<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MBTQ Architecture Documentation</title>
  <style>
    :root {
      --primary: #3b82f6;
      --primary-dark: #1d4ed8;
      --secondary: #8b5cf6;
      --accent: #ec4899;
      --background: #f8fafc;
      --text: #1e293b;
      --text-muted: #64748b;
      --border: #e2e8f0;
      --success: #22c55e;
      --warning: #f59e0b;
      --error: #ef4444;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-color: var(--background);
      color: var(--text);
      line-height: 1.6;
    }
    
    header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      color: white;
      padding: 3rem 1.5rem;
      text-align: center;
    }
    
    header h1 {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
    }
    
    header p {
      font-size: 1.1rem;
      opacity: 0.9;
    }
    
    nav {
      background: white;
      border-bottom: 1px solid var(--border);
      padding: 1rem;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    nav ul {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
      list-style: none;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    nav a {
      color: var(--text);
      text-decoration: none;
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      transition: background-color 0.2s, color 0.2s;
    }
    
    nav a:hover, nav a:focus {
      background-color: var(--primary);
      color: white;
    }
    
    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
    }
    
    section {
      background: white;
      border-radius: 0.5rem;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    h2 {
      color: var(--primary-dark);
      border-bottom: 2px solid var(--primary);
      padding-bottom: 0.5rem;
      margin-bottom: 1.5rem;
      font-size: 1.75rem;
    }
    
    h3 {
      color: var(--secondary);
      margin: 1.5rem 0 1rem;
      font-size: 1.25rem;
    }
    
    h4 {
      color: var(--text);
      margin: 1rem 0 0.5rem;
      font-size: 1.1rem;
    }
    
    p {
      margin-bottom: 1rem;
    }
    
    ul, ol {
      margin-left: 1.5rem;
      margin-bottom: 1rem;
    }
    
    li {
      margin-bottom: 0.5rem;
    }
    
    code {
      background: #f1f5f9;
      padding: 0.125rem 0.375rem;
      border-radius: 0.25rem;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 0.9em;
    }
    
    pre {
      background: #1e293b;
      color: #e2e8f0;
      padding: 1rem;
      border-radius: 0.375rem;
      overflow-x: auto;
      margin: 1rem 0;
    }
    
    pre code {
      background: transparent;
      padding: 0;
      color: inherit;
    }
    
    .highlight {
      background: linear-gradient(90deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
      border-left: 4px solid var(--primary);
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 0 0.375rem 0.375rem 0;
    }
    
    .warning {
      background: rgba(245, 158, 11, 0.1);
      border-left: 4px solid var(--warning);
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 0 0.375rem 0.375rem 0;
    }
    
    .success {
      background: rgba(34, 197, 94, 0.1);
      border-left: 4px solid var(--success);
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 0 0.375rem 0.375rem 0;
    }
    
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin: 1.5rem 0;
    }
    
    .card {
      background: var(--background);
      border: 1px solid var(--border);
      border-radius: 0.5rem;
      padding: 1.5rem;
    }
    
    .card h4 {
      color: var(--primary-dark);
      margin-top: 0;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    
    th, td {
      padding: 0.75rem;
      text-align: left;
      border: 1px solid var(--border);
    }
    
    th {
      background: var(--primary);
      color: white;
    }
    
    tr:nth-child(even) {
      background: var(--background);
    }
    
    .badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.875rem;
      font-weight: 500;
    }
    
    .badge-primary {
      background: var(--primary);
      color: white;
    }
    
    .badge-secondary {
      background: var(--secondary);
      color: white;
    }
    
    .badge-accent {
      background: var(--accent);
      color: white;
    }
    
    footer {
      background: var(--text);
      color: white;
      padding: 2rem 1.5rem;
      text-align: center;
    }
    
    footer a {
      color: var(--primary);
    }
    
    @media (max-width: 768px) {
      header h1 {
        font-size: 1.75rem;
      }
      
      nav ul {
        flex-direction: column;
        align-items: center;
      }
      
      section {
        padding: 1.5rem;
      }
    }
    
    /* Accessibility: Focus indicators */
    a:focus, button:focus {
      outline: 3px solid var(--primary);
      outline-offset: 2px;
    }
    
    /* Skip link for accessibility */
    .skip-link {
      position: absolute;
      top: -40px;
      left: 0;
      background: var(--primary);
      color: white;
      padding: 8px;
      z-index: 1000;
    }
    
    .skip-link:focus {
      top: 0;
    }
  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>
  
  <header>
    <h1>üèóÔ∏è MBTQ Architecture Documentation</h1>
    <p>Comprehensive Architecture for Deaf-First AI Platform with Ethics, Security, and NLP Integration</p>
  </header>
  
  <nav aria-label="Main navigation">
    <ul>
      <li><a href="#overview">Overview</a></li>
      <li><a href="#ethics">Ethics &amp; Inclusion</a></li>
      <li><a href="#security">Security &amp; Consent</a></li>
      <li><a href="#nlp">NLP &amp; Embeddings</a></li>
      <li><a href="#backend">Backend Intelligence</a></li>
      <li><a href="#accessibility">Accessibility</a></li>
      <li><a href="#microservices">Microservices</a></li>
    </ul>
  </nav>
  
  <main id="main-content">
    <!-- Overview Section -->
    <section id="overview">
      <h2>üéØ Architecture Overview</h2>
      <p>
        The MBTQ AI Platform is a revolutionary system designed with a <strong>Deaf-first approach</strong>,
        integrating advanced AI capabilities, blockchain incentives, and comprehensive accessibility features.
        This document serves as the definitive architecture reference for the platform.
      </p>
      
      <div class="highlight">
        <strong>Core Principles:</strong>
        <ul>
          <li>Deaf-first design philosophy - visual-first, no voice-based authentication</li>
          <li>Ethical AI with transparency and consent mechanisms</li>
          <li>Multi-language sign language support (ASL, BSL, and more)</li>
          <li>Blockchain-based incentive system for community contributions</li>
          <li>Enterprise-grade security with accessibility compliance</li>
        </ul>
      </div>
      
      <h3>System Components</h3>
      <div class="grid">
        <div class="card">
          <h4>üîê DeafAUTH</h4>
          <p>Identity Management Service - Central authentication with Passkeys/TOTP, no voice-based auth.</p>
          <span class="badge badge-primary">Port 3001</span>
        </div>
        <div class="card">
          <h4>üîÑ PinkSync</h4>
          <p>Real-time provisioning and synchronization service with SCIM protocol support.</p>
          <span class="badge badge-secondary">Port 3002</span>
        </div>
        <div class="card">
          <h4>üåê Accessibility Nodes</h4>
          <p>Client-side runtime with accessibility enforcement and visual-first properties.</p>
          <span class="badge badge-primary">Port 3003</span>
        </div>
        <div class="card">
          <h4>üìä Fibonrose</h4>
          <p>Reputation, logging, and analytics service with AI embeddings storage.</p>
          <span class="badge badge-accent">Port 3004</span>
        </div>
      </div>
    </section>
    
    <!-- Ethics & Multi-Inclusion Section -->
    <section id="ethics">
      <h2>üåà Ethics &amp; Multi-Inclusion Framework</h2>
      <p>
        Our platform is built on a foundation of ethical AI principles, ensuring inclusive design
        and respectful treatment of all users, particularly the Deaf and hard-of-hearing community.
      </p>
      
      <h3>Deaf-First Design Principles</h3>
      <div class="success">
        <strong>Visual-First Mandate:</strong> All interactions prioritize visual communication.
        Voice-based features are never required and always have visual alternatives.
      </div>
      
      <ul>
        <li><strong>No Voice-Based Authentication:</strong> MFA uses Passkeys or TOTP only</li>
        <li><strong>Captions Always On:</strong> Default setting for all video content</li>
        <li><strong>Sign Language Priority:</strong> ASL, BSL, and other sign languages as primary communication</li>
        <li><strong>Extended Timeouts:</strong> Configurable auth timeout multipliers (1.0x, 2.0x)</li>
        <li><strong>High Contrast Themes:</strong> Multiple visual themes for different needs</li>
      </ul>
      
      <h3>Inclusive User Schema</h3>
      <pre><code>interface UserAccessibilityProfile {
  primary_sign_language: 'ASL' | 'BSL' | 'None';
  caption_preference: 'On' | 'Off';
  auth_timeout_multiplier: 1.0 | 2.0;
  visual_theme_id: 'high_contrast' | 'dark' | 'light';
  is_interpreter: boolean;
  mfa_method: 'Passkey' | 'TOTP';
}</code></pre>
      
      <h3>Ethical AI Guidelines</h3>
      <table>
        <thead>
          <tr>
            <th>Principle</th>
            <th>Implementation</th>
            <th>Validation</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Transparency</td>
            <td>Clear AI decision explanations</td>
            <td>Audit logs for all AI actions</td>
          </tr>
          <tr>
            <td>Fairness</td>
            <td>Bias detection in training data</td>
            <td>Regular fairness audits</td>
          </tr>
          <tr>
            <td>Privacy</td>
            <td>Data minimization practices</td>
            <td>GDPR/CCPA compliance checks</td>
          </tr>
          <tr>
            <td>Accountability</td>
            <td>Human oversight mechanisms</td>
            <td>Escalation procedures</td>
          </tr>
          <tr>
            <td>Inclusion</td>
            <td>Community feedback integration</td>
            <td>Accessibility testing</td>
          </tr>
        </tbody>
      </table>
    </section>
    
    <!-- Security & Consent Section -->
    <section id="security">
      <h2>üîí Security &amp; Consent Architecture</h2>
      <p>
        Comprehensive security framework with explicit consent mechanisms, designed to protect
        user data while maintaining transparency about data usage.
      </p>
      
      <h3>Consent Management System</h3>
      <div class="warning">
        <strong>Security Debt Acknowledgment:</strong> All consent records include tracking for
        security debt, ensuring timely review and updates of consent agreements.
      </div>
      
      <h4>Consent Categories</h4>
      <ul>
        <li><strong>Essential:</strong> Required for platform operation (authentication, session management)</li>
        <li><strong>Functional:</strong> Accessibility preferences, UI customization</li>
        <li><strong>Analytics:</strong> Usage patterns for platform improvement (opt-in)</li>
        <li><strong>AI Training:</strong> Contribution to model improvement (explicit opt-in)</li>
        <li><strong>Marketing:</strong> Communication preferences (opt-in)</li>
      </ul>
      
      <h3>Logging Architecture</h3>
      <pre><code>interface SecurityLog {
  id: string;
  timestamp: Date;
  event_type: 'AUTH' | 'ACCESS' | 'DATA' | 'CONSENT' | 'API';
  user_id?: string;
  action: string;
  metadata: {
    ip_address_hash: string;
    user_agent: string;
    consent_version: string;
    security_debt_flag: boolean;
  };
  audit_trail: AuditEntry[];
}</code></pre>
      
      <h3>Security Layers</h3>
      <div class="grid">
        <div class="card">
          <h4>Authentication Layer</h4>
          <ul>
            <li>Passkey-first authentication</li>
            <li>TOTP as fallback MFA</li>
            <li>JWT with accessibility attributes</li>
            <li>Session management with secure cookies</li>
          </ul>
        </div>
        <div class="card">
          <h4>Authorization Layer</h4>
          <ul>
            <li>Role-based access control (RBAC)</li>
            <li>Resource-level permissions</li>
            <li>API key management</li>
            <li>Rate limiting per user/tier</li>
          </ul>
        </div>
        <div class="card">
          <h4>Data Protection Layer</h4>
          <ul>
            <li>Encryption at rest (AES-256)</li>
            <li>TLS 1.3 for transit</li>
            <li>Data anonymization pipelines</li>
            <li>Secure data deletion workflows</li>
          </ul>
        </div>
      </div>
      
      <h3>Security Debt Tracking</h3>
      <table>
        <thead>
          <tr>
            <th>Category</th>
            <th>Tracking Method</th>
            <th>Review Cycle</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Consent Agreements</td>
            <td>Version control with expiry dates</td>
            <td>Quarterly</td>
          </tr>
          <tr>
            <td>Dependency Vulnerabilities</td>
            <td>Automated scanning (npm audit)</td>
            <td>Weekly</td>
          </tr>
          <tr>
            <td>Access Permissions</td>
            <td>Periodic access reviews</td>
            <td>Monthly</td>
          </tr>
          <tr>
            <td>API Security</td>
            <td>Penetration testing</td>
            <td>Bi-annually</td>
          </tr>
        </tbody>
      </table>
    </section>
    
    <!-- NLP & Embeddings Section -->
    <section id="nlp">
      <h2>üß† NLP &amp; Embeddings Integration</h2>
      <p>
        Advanced Natural Language Processing capabilities with vector embeddings for semantic
        understanding and sign language interpretation.
      </p>
      
      <h3>Embeddings Architecture</h3>
      <div class="highlight">
        <strong>ChromaDB Integration:</strong> Vector storage for AI embeddings enabling semantic
        search, context retrieval, and enhanced sign language interpretation.
      </div>
      
      <h4>Embedding Pipeline</h4>
      <pre><code>// Embedding Generation Pipeline
const embeddingPipeline = {
  model: 'text-embedding-3-small',
  provider: 'OpenAI',
  dimensions: 1536,
  
  preprocessing: {
    normalize: true,
    removeStopWords: false, // Important for sign language context
    preserveSignMarkers: true
  },
  
  storage: {
    vectorDB: 'ChromaDB',
    keyspace: 'mbtq_embeddings',
    indexType: 'HNSW'
  }
};</code></pre>
      
      <h3>NLP Components</h3>
      <div class="grid">
        <div class="card">
          <h4>Sign Language Understanding</h4>
          <p>Semantic interpretation of sign language gestures with context awareness.</p>
          <ul>
            <li>Gesture-to-text conversion</li>
            <li>Context-aware interpretation</li>
            <li>Multi-sign language support</li>
          </ul>
        </div>
        <div class="card">
          <h4>Text-to-Sign Translation</h4>
          <p>Generate sign language representations from text input.</p>
          <ul>
            <li>AWS GenASL integration</li>
            <li>Avatar animation generation</li>
            <li>Regional dialect support</li>
          </ul>
        </div>
        <div class="card">
          <h4>Semantic Search</h4>
          <p>Vector similarity search for content discovery and retrieval.</p>
          <ul>
            <li>Sign vocabulary lookup</li>
            <li>Related content discovery</li>
            <li>Training data retrieval</li>
          </ul>
        </div>
      </div>
      
      <h3>LangChain Orchestration</h3>
      <pre><code>// LangChain Integration
import { ChatOpenAI } from '@langchain/openai';
import { ChromaDB } from 'chromadb';

const nlpOrchestration = {
  llm: new ChatOpenAI({ model: 'gpt-4' }),
  
  chains: {
    signInterpretation: 'RAG chain for sign language context',
    contentGeneration: 'Chain for accessible content creation',
    qualityAssurance: 'Chain for interpretation validation'
  },
  
  retrievers: {
    signVocabulary: 'ChromaDB retriever for sign vocabulary',
    userContext: 'User preference-aware retriever',
    domainSpecific: 'Industry-specific terminology retriever'
  }
};</code></pre>
      
      <h3>Embeddings Use Cases</h3>
      <table>
        <thead>
          <tr>
            <th>Use Case</th>
            <th>Embedding Type</th>
            <th>Purpose</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Sign Vocabulary</td>
            <td>Gesture embeddings</td>
            <td>Sign recognition and matching</td>
          </tr>
          <tr>
            <td>User Queries</td>
            <td>Text embeddings</td>
            <td>Semantic search and retrieval</td>
          </tr>
          <tr>
            <td>Content Indexing</td>
            <td>Document embeddings</td>
            <td>Knowledge base organization</td>
          </tr>
          <tr>
            <td>Reputation Scoring</td>
            <td>Behavior embeddings</td>
            <td>Trust and quality assessment</td>
          </tr>
        </tbody>
      </table>
    </section>
    
    <!-- Backend Intelligence Section -->
    <section id="backend">
      <h2>‚ö° Backend Intelligence &amp; Validations</h2>
      <p>
        Multi-tier backend architecture with intelligent validation layers ensuring data integrity,
        security compliance, and optimal performance.
      </p>
      
      <h3>Validation Tier Architecture</h3>
      <div class="grid">
        <div class="card">
          <h4>Tier 1: Input Validation</h4>
          <span class="badge badge-primary">Zod Schemas</span>
          <p>Type-safe input validation using Zod for all API endpoints.</p>
          <pre><code>const userSchema = z.object({
  email: z.string().email(),
  signLanguage: z.enum(['ASL', 'BSL']),
  captionPref: z.boolean()
});</code></pre>
        </div>
        <div class="card">
          <h4>Tier 2: Business Logic</h4>
          <span class="badge badge-secondary">tRPC Procedures</span>
          <p>Type-safe API layer with automatic validation and error handling.</p>
          <pre><code>const router = t.router({
  interpret: t.procedure
    .input(interpretSchema)
    .mutation(async (opts) => {
      // Business logic
    })
});</code></pre>
        </div>
        <div class="card">
          <h4>Tier 3: Data Integrity</h4>
          <span class="badge badge-accent">Prisma ORM</span>
          <p>Database-level constraints and referential integrity.</p>
          <pre><code>model User {
  id    String @id @default(cuid())
  email String @unique
  @@index([signLanguage])
}</code></pre>
        </div>
      </div>
      
      <h3>Intelligence Layers</h3>
      <h4>AI-Powered Validations</h4>
      <ul>
        <li><strong>Content Moderation:</strong> AI-driven content safety checks</li>
        <li><strong>Quality Assessment:</strong> Automated quality scoring for contributions</li>
        <li><strong>Anomaly Detection:</strong> Pattern recognition for security threats</li>
        <li><strong>Accessibility Compliance:</strong> Automated WCAG validation</li>
      </ul>
      
      <h4>Integration Points</h4>
      <pre><code>// Backend Intelligence Integration
const intelligenceLayer = {
  validation: {
    input: 'Zod schema validation',
    business: 'tRPC procedure guards',
    ai: 'LangChain quality chains'
  },
  
  processing: {
    signInterpretation: 'Computer vision pipeline',
    textGeneration: 'OpenAI GPT-4',
    avatarGeneration: 'AWS GenASL'
  },
  
  storage: {
    primary: 'PostgreSQL via Prisma',
    vectors: 'ChromaDB',
    logs: 'Astra DB (Cassandra)'
  },
  
  caching: {
    session: 'Redis',
    api: 'Edge caching'
  }
};</code></pre>
      
      <h3>Validation Flow</h3>
      <table>
        <thead>
          <tr>
            <th>Stage</th>
            <th>Validator</th>
            <th>Action on Failure</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Request Entry</td>
            <td>Rate limiter + Auth check</td>
            <td>429/401 response</td>
          </tr>
          <tr>
            <td>Input Parsing</td>
            <td>Zod schema validation</td>
            <td>400 with validation errors</td>
          </tr>
          <tr>
            <td>Authorization</td>
            <td>RBAC permission check</td>
            <td>403 forbidden</td>
          </tr>
          <tr>
            <td>Business Rules</td>
            <td>tRPC procedure logic</td>
            <td>Domain-specific error</td>
          </tr>
          <tr>
            <td>AI Processing</td>
            <td>Quality/safety checks</td>
            <td>Queued for review</td>
          </tr>
          <tr>
            <td>Persistence</td>
            <td>Database constraints</td>
            <td>Transaction rollback</td>
          </tr>
        </tbody>
      </table>
    </section>
    
    <!-- Accessibility Safeguards Section -->
    <section id="accessibility">
      <h2>üåç Cosmopolitan Accessibility Safeguards</h2>
      <p>
        Universal accessibility design ensuring the platform works for users across different
        cultures, abilities, and technological contexts.
      </p>
      
      <h3>Internationalization (i18n)</h3>
      <div class="highlight">
        <strong>Multi-Language Support:</strong> Platform supports multiple spoken and sign languages,
        with proper RTL support and cultural adaptations.
      </div>
      
      <ul>
        <li><strong>Sign Languages:</strong> ASL, BSL, Auslan, LSF, DGS, and more</li>
        <li><strong>Spoken Languages:</strong> English, Spanish, French, German, etc.</li>
        <li><strong>RTL Support:</strong> Arabic, Hebrew interface support</li>
        <li><strong>Cultural Adaptations:</strong> Region-specific sign variations</li>
      </ul>
      
      <h3>WCAG 2.1 AA Compliance</h3>
      <div class="grid">
        <div class="card">
          <h4>Perceivable</h4>
          <ul>
            <li>Text alternatives for all media</li>
            <li>Captions for all video content</li>
            <li>Sufficient color contrast (4.5:1)</li>
            <li>Resizable text up to 200%</li>
          </ul>
        </div>
        <div class="card">
          <h4>Operable</h4>
          <ul>
            <li>Full keyboard navigation</li>
            <li>No keyboard traps</li>
            <li>Extended time limits</li>
            <li>Skip navigation links</li>
          </ul>
        </div>
        <div class="card">
          <h4>Understandable</h4>
          <ul>
            <li>Consistent navigation</li>
            <li>Clear error messages</li>
            <li>Input assistance</li>
            <li>Predictable behavior</li>
          </ul>
        </div>
        <div class="card">
          <h4>Robust</h4>
          <ul>
            <li>Valid HTML markup</li>
            <li>ARIA labels where needed</li>
            <li>Compatible with assistive tech</li>
            <li>Progressive enhancement</li>
          </ul>
        </div>
      </div>
      
      <h3>Accessibility Node Configuration</h3>
      <pre><code>// Accessibility Node Runtime Configuration
const accessibilityConfig = {
  visual: {
    disableVoicePrompts: true,
    enableCaptions: true,
    highContrastMode: 'auto',
    largeFrameRendering: true
  },
  
  input: {
    extendedTimeouts: true,
    keyboardOnlyMode: 'supported',
    gestureRecognition: true
  },
  
  output: {
    signLanguageHints: true,
    visualNotifications: true,
    hapticFeedback: 'optional'
  },
  
  sync: {
    realTimeUpdates: true,
    offlineCapability: true,
    syncInterval: 5000
  }
};</code></pre>
      
      <h3>Safeguard Mechanisms</h3>
      <table>
        <thead>
          <tr>
            <th>Safeguard</th>
            <th>Purpose</th>
            <th>Implementation</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Voice Prompt Blocker</td>
            <td>Prevent voice-only interactions</td>
            <td>Middleware filter on all responses</td>
          </tr>
          <tr>
            <td>Caption Enforcer</td>
            <td>Ensure all media has captions</td>
            <td>Content validation pipeline</td>
          </tr>
          <tr>
            <td>Timeout Extender</td>
            <td>Allow more time for interactions</td>
            <td>Configurable session parameters</td>
          </tr>
          <tr>
            <td>Contrast Checker</td>
            <td>Verify visual accessibility</td>
            <td>Automated UI testing</td>
          </tr>
          <tr>
            <td>Keyboard Navigator</td>
            <td>Full keyboard support</td>
            <td>Focus management system</td>
          </tr>
        </tbody>
      </table>
    </section>
    
    <!-- Microservices Architecture Section -->
    <section id="microservices">
      <h2>üèóÔ∏è Microservices Architecture</h2>
      <p>
        Distributed system design with clear service boundaries, enabling scalability,
        maintainability, and independent deployment.
      </p>
      
      <h3>Service Topology</h3>
      <div class="highlight">
        <strong>Design Philosophy:</strong> Each service is independently deployable, has its own
        database, and communicates via well-defined APIs (tRPC for internal, REST for external).
      </div>
      
      <h4>Service 1: DeafAUTH (Identity Management)</h4>
      <pre><code>Service: DeafAUTH
Port: 3001
Stack: Next.js 14 + Better Auth + Prisma
Database: PostgreSQL

Responsibilities:
- User authentication (Passkeys, TOTP)
- Session management (JWT)
- Accessibility profile storage
- OAuth provider integration</code></pre>
      
      <h4>Service 2: PinkSync (Provisioning)</h4>
      <pre><code>Service: PinkSync
Port: 3002
Stack: Node.js + Fastify + RabbitMQ
Protocol: SCIM + WebSockets

Responsibilities:
- Real-time event propagation
- Profile synchronization
- CI/CD pipeline triggers
- Cross-service coordination</code></pre>
      
      <h4>Service 3: Accessibility Nodes (Runtime)</h4>
      <pre><code>Service: Accessibility Nodes
Port: 3003
Stack: Next.js 14 + React 19 + Chakra UI
State: Zustand

Responsibilities:
- Client-side accessibility enforcement
- Visual-first UI rendering
- JWT token validation
- User preference application</code></pre>
      
      <h4>Service 4: Fibonrose (Reputation &amp; Logging)</h4>
      <pre><code>Service: Fibonrose
Port: 3004
Stack: Next.js 14 + Astra DB + ChromaDB
API: tRPC + REST

Responsibilities:
- Comprehensive event logging
- Reputation score calculation
- AI embeddings storage
- Analytics and reporting</code></pre>
      
      <h3>Inter-Service Communication</h3>
      <table>
        <thead>
          <tr>
            <th>From</th>
            <th>To</th>
            <th>Protocol</th>
            <th>Purpose</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>DeafAUTH</td>
            <td>PinkSync</td>
            <td>RabbitMQ</td>
            <td>Auth events broadcast</td>
          </tr>
          <tr>
            <td>PinkSync</td>
            <td>Accessibility Nodes</td>
            <td>WebSocket</td>
            <td>Real-time profile updates</td>
          </tr>
          <tr>
            <td>All Services</td>
            <td>Fibonrose</td>
            <td>tRPC</td>
            <td>Logging and analytics</td>
          </tr>
          <tr>
            <td>Accessibility Nodes</td>
            <td>DeafAUTH</td>
            <td>tRPC</td>
            <td>Token validation</td>
          </tr>
        </tbody>
      </table>
      
      <h3>Deployment Architecture</h3>
      <pre><code>// Kubernetes Deployment Overview
infrastructure:
  orchestration: Kubernetes
  containerization: Docker
  
  services:
    - name: deafauth
      replicas: 3
      resources:
        cpu: 500m
        memory: 512Mi
        
    - name: pinksync
      replicas: 2
      resources:
        cpu: 250m
        memory: 256Mi
        
    - name: accessibility-nodes
      replicas: 5
      resources:
        cpu: 1000m
        memory: 1Gi
        
    - name: fibonrose
      replicas: 2
      resources:
        cpu: 500m
        memory: 512Mi
        
  networking:
    ingress: nginx
    tls: cert-manager
    dns: cloudflare</code></pre>
    </section>
    
    <!-- Quick Reference Section -->
    <section id="reference">
      <h2>üìö Quick Reference</h2>
      
      <h3>Technology Stack Summary</h3>
      <table>
        <thead>
          <tr>
            <th>Layer</th>
            <th>Technology</th>
            <th>Purpose</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Frontend</td>
            <td>Next.js 14, React 19, Tailwind CSS</td>
            <td>UI rendering and routing</td>
          </tr>
          <tr>
            <td>Authentication</td>
            <td>Better Auth</td>
            <td>Deaf-first auth (Passkeys, TOTP)</td>
          </tr>
          <tr>
            <td>API Layer</td>
            <td>tRPC, Fastify</td>
            <td>Type-safe internal APIs</td>
          </tr>
          <tr>
            <td>Database</td>
            <td>PostgreSQL, Astra DB</td>
            <td>Primary and logging storage</td>
          </tr>
          <tr>
            <td>Vector Store</td>
            <td>ChromaDB</td>
            <td>AI embeddings</td>
          </tr>
          <tr>
            <td>AI/ML</td>
            <td>OpenAI, LangChain</td>
            <td>NLP and orchestration</td>
          </tr>
          <tr>
            <td>Message Queue</td>
            <td>RabbitMQ</td>
            <td>Event-driven architecture</td>
          </tr>
          <tr>
            <td>Deployment</td>
            <td>Docker, Kubernetes</td>
            <td>Container orchestration</td>
          </tr>
        </tbody>
      </table>
      
      <h3>Port Reference</h3>
      <div class="grid">
        <div class="card">
          <h4>Development Ports</h4>
          <ul>
            <li><code>3001</code> - DeafAUTH</li>
            <li><code>3002</code> - PinkSync</li>
            <li><code>3003</code> - Accessibility Nodes</li>
            <li><code>3004</code> - Fibonrose</li>
          </ul>
        </div>
        <div class="card">
          <h4>External Services</h4>
          <ul>
            <li><code>5432</code> - PostgreSQL</li>
            <li><code>5672</code> - RabbitMQ</li>
            <li><code>6379</code> - Redis</li>
            <li><code>8000</code> - ChromaDB</li>
          </ul>
        </div>
      </div>
      
      <div class="success">
        <strong>Documentation Authority:</strong> This document serves as the architectural
        reference for the MBTQ AI Platform. For the complete single source of truth including
        NPM dependencies and code examples, see <code>docs/singlesource.md</code>.
      </div>
    </section>
  </main>
  
  <footer>
    <p>
      <strong>MBTQ Architecture Documentation</strong> | Version 1.0.0 | Last Updated: December 2024
    </p>
    <p>
      <a href="https://ai.mbtq.dev" rel="noopener noreferrer">ai.mbtq.dev</a> |
      <a href="mailto:dev@signlanguageai.com" rel="noopener noreferrer">dev@signlanguageai.com</a>
    </p>
    <p>
      Made with ‚ù§Ô∏è by MBTQ AI - Advancing AI for Accessibility
    </p>
  </footer>
</body>
</html>
